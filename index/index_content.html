<!DOCTYPE html>
<html class="um  landscape min-width-240px min-width-320px min-width-480px min-width-768px min-width-1024px" ontouchstart>

	<head>
		<title></title>
		<meta charset="utf-8">
		<meta name="viewport" content="target-densitydpi=device-dpi, width=device-width, initial-scale=1, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<link rel="stylesheet" href="../common/css/fonts/font-awesome.min.css">
		<link rel="stylesheet" href="../common/css/ui-box.css">
		<link rel="stylesheet" href="../common/css/ui-base.css">
		<link rel="stylesheet" href="../common/css/ui-color.css">
		<link rel="stylesheet" href="../common/css/appcan.icon.css">
		<link rel="stylesheet" href="../common/css/appcan.control.css">
		<link rel="stylesheet" href="index_content/css/main.css">
		<link rel="stylesheet" href="../common/css/app.css">
		<link rel="stylesheet" href="../common/css/swiper/swiper.min.css" />
	</head>

	<body class="ub ub-ver bc-bg">

		<!--  图片轮播开始-->
		<div class="swiper-container ">
			<div class="swiper-wrapper ">
				<!--<div class="swiper-slide swiper-no-swiping">
					<img src="../images/img1.png" class="img_height " />
				</div>
				<div class="swiper-slide swiper-no-swiping">
					<img src="../images/img2.png" class="img_height" />
				</div>-->

			</div>
		</div>
		<!--    图片轮播结束-->
		<div class="ub ub-ver">
			<!--最外层div开始-->
			<div class="uh_head"></div>
			<div class="ub ub-ac btn-b bc-bg">
				<!--中间四个按钮开始开始-->
				<div class="ub ub-ver ub-ac ub-f1 allbtn" id="btn1">
					<div class=" btn_wh1 ub-img eleIcon1"></div>
					<div class="ub ub-ac btn-four">
						学生分期额度申请
					</div>
				</div>
				<div class="ub ub-ver ub-ac ub-f1 allbtn" id="btn2">
					<div class=" btn_wh1 ub-img eleIcon2"></div>
					<div class="ub ub-ac btn-four">
						查看订单
					</div>
				</div>
				<!--
				<div class="ub ub-ver ub-f1 ub-ac allbtn" id="btn3">
					<div class=" btn_wh1 ub-img eleIcon3"></div>
					<div class="ub ub-ac btn-four">
						我要还款
					</div>
				</div>
				-->
				<div class="ub ub-ver ub-f1 ub-ac allbtn" id="btn4">
					<div class=" btn_wh1 ub-img phonefee"></div>
					<div class="ub ub-ac ub-f1 btn-four">
						话费充值
					</div>
				</div>
				<div class="ub ub-ver ub-f1 ub-ac allbtn" id="btn5">
					<div class=" btn_wh1 ub-img eleIcon4"></div>
					<div class="ub ub-ac ub-f1 btn-four">
						扫描支付
					</div>
				</div>
			</div>
			<!--中间四个按钮接收-->
			<div class="ub ub-ver btn-fenge"></div>
			<!--灰色分隔条-->
			<!--热卖商品标题开始-->
			<div class="ub ub-ac re-rehight hot-shop-bg">
				<div class="re-rehight-bod ub-ac ub">
					<div class="hot-shop-font">
						热卖商品
					</div>
				</div>
			</div>
			<!--热卖商品标题结束-->
			<!--最外边大盒子开始-->
			<div id="hothidden" class="ub ub-father-bd tj-text-over re-left-divhi uhide">

				<!--热卖商品左边大盒子开始-->
				<div class="ub ub-f1 ub-ver ub-fh ub-fv re-small-left" FshoperId='' FavgNumber='' id="hoteleft" onclick="">
					<div class="ub ub-f1 ub-ver re-margin-left1">
						<div id="" class=" re-text-forfont tj-text-over re-text-center goods_name">

						</div>
						<div id="" class="ub re-text-forfont re-hot-lineheight tj-text-over">
							<div>
								月供:￥
							</div>
							<div class="Fmoneymonth">

							</div>
							<div class="uhide shop_price">

							</div>
						</div>
					</div>
					<div class="ub ub-ac ub-pc ub-img ">
						<img src="../images/shoujitest.png" class="goodsimgs re-big-image" />
					</div>
				</div>
				<!--热卖商品左边盒子结束-->

				<!--热卖商品右边大盒子开始-->
				<div class="ub ub-ac ub-pc ub-ver ub-f1 ub-fh ub-fv">
					<div class="ub ub-f1 ub-fh re-border" id="hoteright1" FshoperId='' FavgNumber='' onclick="">
						<div id="" class="re-margin-left re-hot-width bill_font_size">
							<div id="" class=" re-text-forfont tj-text-over re-text-center goods_name">

							</div>
							<div id="" class="ub re-text-forfont re-hot-lineheight tj-text-over">
								<div>
									月供:￥
								</div>
								<div class="Fmoneymonth">

								</div>
								<div class="uhide shop_price">

								</div>

							</div>
						</div>
						<div class="ub ub-f1 ub-ac ub-pe umar-r">
							<div id="" class="ub ub-ac">
								<img src="../images/shoujitest.png" class="goodsimgs re-image re-margin" />
							</div>
						</div>
					</div>
					<div class="ub ub-f1 ub-fh" id="hoteright2" onclick="">
						<div id="" class="re-margin-left re-hot-width bill_font_size">
							<div id="" class=" re-text-forfont tj-text-over re-text-center goods_name">

							</div>
							<div id="" class="ub re-text-forfont re-hot-lineheight tj-text-over">
								<div>
									月供:￥
								</div>
								<div class="Fmoneymonth">

								</div>
								<div class="uhide shop_price">

								</div>
							</div>
						</div>
						<div class="ub ub-f1 ub-ac ub-pe umar-r">
							<div id="" class="ub ub-ac ">
								<img src="../images/shoujitest.png" class="goodsimgs re-image re-margin" />
							</div>
						</div>
					</div>
				</div>

			</div>
			<!--热卖商品右边大盒子结束-->
		</div>
		<div class="ub ub-ver btn-fenge"></div>
		<div class="ub ub-ac hot-shop-bg re-rehight">
			<div class="re-rehight-bod"></div>
			<div class="hot-shop-font">
				推荐商品
			</div>
		</div>
		<!--推荐商品最外边大盒子开始-->
		<div id="list" class="list">

		</div>
		<div id="tmp" class="tmp ub ub-ver uhide">
			<div class="item ub ub-ac ub-pc uinn hot-shop-bg1 tj-div-height tj-ub-father-bd" FshoperId='' id="goods1" FavgNumber='' onclick="">
				<div class="ub ub-ac tj-div-with">
					<img src="../images/shoujitest.png" class="goodsimgs re_goods" />
				</div>
				<div class="ub ub-f1">
					<div class="ub ub-ver ub-f1 ub-fh ub-fv ">
						<div class="tj-text-forfont tj-text-over tj-line-height goods_name">
							苹果iphone6s
						</div>
						<div class="ub ub-ac  tj-text-forfont  ">
							<div class="fa fa-tag tj-fa-col"></div>
							<div class="tj-text-forfont tj-line-height tj-text-over tj-divpad-fon tj-div-cuxiao">
								低价促销
							</div>
						</div>
						<div class="ub tj-text-forfont tj-text-over tj-line-height ">
							<div>
								月供：￥
							</div>
							<div class="Fmoneymonth">

							</div>
						</div>
						<div class="ub tj-text-forfont tj-text-over tj-line-height ">
							<div class="">
								售价：￥
							</div>
							<div id="" class="shop_price">

							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<script src="../common/js/appcan.js"></script>
		<script src="../common/js/appcan.control.js"></script>
		<script src="../common/js/appcan.slider.js"></script>
		<script src="../common/js/swiper/swiper.min.js"></script>
		<script type="text/javascript" src="../common/js/yfkj.js"></script>
	</body>
	<script>
		var pageno = 0;
		var star = 0;
		var pagesize = 3;
		appcan.ready(function() {
			uexScanner.cbOpen = ScannerCallBack;
			appcan.window.subscribe('myindex0', function(msg) {
				getHotGoods();
				pageno = 0;
				star = 0;
				$(".list").empty();
				getBestGoods(++pageno, star);
			});
			//图片轮播
			getIndexImg();
			//热卖商品
			getHotGoods();
			//推荐商品
			getBestGoods(++pageno, star);
			appcan.window.subscribe('getuserinfo', function(msg) {
				getuserinfo();
			});
			appcan.frame.setBounce([0, 1], function(type) {}, function(type) {}, function(type) {
				if (type == 0) {
					pageno = 0;
					star = 0;
					$(".list").empty();
					getuserinfo();
				}
				getBestGoods(++pageno, star);
				setTimeout(function() {
					appcan.frame.resetBounce(type);
				}, 1000);
			});
			//                   图片轮播js
			//			var swiper = new Swiper('.swiper-container', {
			//				pagination: '.swiper-pagination',
			//				nextButton: '.swiper-button-next',
			//				prevButton: '.swiper-button-prev',
			//				paginationClickable: true,
			//				spaceBetween: 0,
			//				centeredSlides: true,
			//				autoplay: 2000, //动画播放时间间隔在此设置
			//				autoplayDisableOnInteraction: false,
			//				//noSwiping:true,
			//			});
		});
		//获取热卖商品
		function getHotGoods() {
			appcan.ajax({
				url: Serverurl + "/user/getHotGoods",
				type: "POST",
				dataType: 'json',
				success: function(result) {
					var msg = result.Msg;
					if (msg == 1) {
						var length = result.Data.length;
						var data = result.Data;
						for (var i = 0; i < length; i++) {
							if (i == 0) {
								var hoteleft = $("#hoteleft");
								hoteleft.attr("id", "hot" + data[i].goods_id);
								hoteleft.attr("FshoperId", data[i].Fshoperid);
								hoteleft.find(".goods_name").text(data[i].goods_name);
								hoteleft.find(".Fmoneymonth").text(Number(data[i].Fmoneymonth).toFixed(2));
								hoteleft.find(".goodsimgs").attr("src", Serverurl + data[i].goods_img);
								hoteleft.attr("onclick", "selecthotgoods('" + data[i].goods_id + "')");
								hoteleft.attr("FavgNumber", data[i].FavgNumber);
								hoteleft.find(".shop_price").text(data[i].shop_price);
							} else if (i == 1) {
								var hoteleft = $("#hoteright1");
								hoteleft.attr("id", "hot" + data[i].goods_id);
								hoteleft.attr("FshoperId", data[i].Fshoperid);
								hoteleft.find(".goods_name").text(data[i].goods_name);
								hoteleft.find(".Fmoneymonth").text(Number(data[i].Fmoneymonth).toFixed(2));
								hoteleft.find(".goodsimgs").attr("src", Serverurl + data[i].goods_img);
								hoteleft.attr("onclick", "selecthotgoods('" + data[i].goods_id + "')");
								hoteleft.attr("FavgNumber", data[i].FavgNumber);
								hoteleft.find(".shop_price").text(data[i].shop_price);
							} else if (i == 2) {
								var hoteleft = $("#hoteright2");
								hoteleft.attr("id", "hot" + data[i].goods_id);
								hoteleft.attr("FshoperId", data[i].Fshoperid);
								hoteleft.find(".goods_name").text(data[i].goods_name);
								hoteleft.find(".shop_price").text(data[i].shop_price);
								hoteleft.find(".Fmoneymonth").text(Number(data[i].Fmoneymonth).toFixed(2));
								hoteleft.find(".goodsimgs").attr("src", Serverurl + data[i].goods_img);
								hoteleft.attr("onclick", "selecthotgoods('" + data[i].goods_id + "')");
								hoteleft.attr("FavgNumber", data[i].FavgNumber);
							}
						}
					}
					$("#hothidden").removeClass('uhide');
				},
				error: function(e) {
					appcan.window.openToast("服务器出错", "1000");
				}
			});
		}
		//获取推荐商品
		function getBestGoods(apageno, astart) {
			var datas = {
				Fstart: astart,
				pageSize: pagesize,
				currentPageNum: apageno
			};
			appcan.ajax({
				url: Serverurl + "/user/getBestGoods",
				type: "POST",
				dataType: 'json',
				data: datas,
				success: function(result) {
					var msg = result.Msg;
					if (msg == 1) {
						var length = result.Data.Data.length;
						var fulltag = result.Data.fulltag;
						var lastno = result.Data.lastno;
						if (fulltag == 0) {
							pageno = pageno - 1;
						}
						star = lastno;
						for (var i = 0; i < length; i++) {
							additem(result.Data.Data[i]);
							//加载账单
						}
						//appcan.window.openToast('数据加载成功', '1000');
					}
					if (msg == 0) {
						pageno = pageno - 1;
					}
				},
				error: function(e) {
					appcan.window.openToast("服务器出错", "1000");
				}
			});
		}

		function additem(data) //加载推荐商品
		{
			var list = $(".list");
			var clonedom = $("#tmp").clone();
			var itemdom = clonedom.find(".item");
			itemdom.attr("id", "item" + data.goods_id);
			itemdom.attr("FshoperId", data.Fshoperid);
			itemdom.attr("FavgNumber", data.FavgNumber);
			itemdom.find(".goods_name").text(data.goods_name);
			itemdom.find(".shop_price").text(Number(data.shop_price).toFixed(2));
			itemdom.find(".Fmoneymonth").text(Number(data.Fmoneymonth).toFixed(2));
			itemdom.find(".goodsimgs").attr("src", Serverurl + data.goods_img);
			itemdom.attr("onclick", "selectgoods('" + data.goods_id + "')");
			list.append(itemdom);
		}
		//热卖商品点击事件
		function selecthotgoods(sid) {
			var shopdatas = {
				FshoperId: $("#hot" + sid).attr('FshoperId'),
				goods_id: sid,
				goods_name: $("#hot" + sid + " .goods_name").text(),
				shop_price: $("#hot" + sid + " .shop_price").text(),
				FavgNumber: $("#hot" + sid).attr('FavgNumber')
			};
			appcan.locStorage.setVal("goodsinfo", shopdatas);
			appcan.window.open("shopInfo", "../shoping/goodsInfo/shopInfo.html");
		}
		//推荐商品点击事件
		function selectgoods(sid) {
			var shopdatas = {
				FshoperId: $("#item" + sid).attr('FshoperId'),
				goods_id: sid,
				goods_name: $("#item" + sid + " .goods_name").text(),
				shop_price: $("#item" + sid + " .shop_price").text(),
				FavgNumber: $("#item" + sid).attr('FavgNumber')
			};
			appcan.locStorage.setVal("goodsinfo", shopdatas);
			appcan.window.open("shopInfo", "../shoping/goodsInfo/shopInfo.html");
		}
		//额度申请点击事件
		appcan.button("#btn1", "ani-act", function(a, b) {
				getuserinfo();
				if (cheackstat() == 0) {
					return;
				}
				appcan.window.open({
					name: "applay",
					dataType: 0,
					aniId: 9,
					data: "../applay/approve/approve.html"
				});
			})
			//快速提现点击事件
		appcan.button("#btn2", "ani-act", function(a, b) {
		    appcan.locStorage.setVal("orderindex", 0);
		     appcan.locStorage.setVal("footindex", 0);
                appcan.window.open({
                    name: "bill",
                    dataType: 0,
                    aniId: 9,
                    data: "../myorder/order.html"
                });
				//if (cheackstat() == 0) {
					//return;
				//}
				//appcan.window.open("takemoney", "../takemoney/takemoney.html");
				//appcan.window.publish('takemoney', '');
				//				appcan.window.publish('move', '1');
			}) //我要还款点击事件
		appcan.button("#btn3", "ani-act", function(a, b) {
				if (cheackstat() == 0) {
					return;
				}
				//appcan.locStorage.setVal("orderindex", 1);
				appcan.locStorage.setVal("billindex", 0);
				appcan.window.open({
					name: "bill",
					dataType: 0,
					aniId: 9,
					data: "../bill/bill.html"
				});
			})
			//话费充值点击事件
		appcan.button("#btn4", "ani-act", function(a, b) {
				var userid = getuserid();
				if (userid == -1) {
					appcan.window.alert({
						title: "提示",
						content: "您没有登陆或者注册",
						buttons: ['取消', '去完成'],
						callback: function(err, data, dataType, optId) {
							if (data == 1) {
								appcan.window.open({
									name: "login",
									aniId: 1,
									data: "../login/login.html",
								});
							}
						}
					});
				} else {
					appcan.window.open("prepaid", "../prepaid/prepaid.html");
				}
			})
			//扫描支付点击事件
		appcan.button("#btn5", "ani-act", function(a, b) {
			uexScanner.open();
		})

		function ScannerCallBack(opCode, dataType, data) {
			var datas = JSON.parse(data);
			var shopdatas = {
				FshoperId: datas.code
			};
			appcan.locStorage.setVal("shopinfo", shopdatas);
			appcan.window.open("seller_consume", "../shoping/seller_consume/seller_consume.html");
		}

		function getuserinfo() {
			appcan.ajax({
				url: Serverurl + "/user/getuserinfo",
				dataType: 'json',
				type: "POST",
				data: {
					"Fuserid": getuserid(),
					"Fpassword": getuserpassword()
				},
				success: function(result) {
					var msg = result.Msg;
					if (msg == '1') {
						var dota = result.Data[0];
						appcan.locStorage.setVal("userinfo", dota);
					}
				},
				error: function(e) {
					appcan.window.openToast('服务器出错!', '1000');
				}
			});
		}
		//首页图片轮播
		function getIndexImg() {
			appcan.ajax({
				url: Serverurl + "/user/getIndexImg",
				type: "POST",
				dataType: 'json',
				success: function(result) {
					var data = result.Data;
					if (result.Msg == '1') {
						var length = data.length;
						for (var i = 0; i < length; i++) {
							var imgs = data[i].Fimages;
							var newimg = imgs.split(',');
							for (var i = 0; i < newimg.length; i++) {
								var img = '<div class="swiper-slide swiper-no-swiping"><img src=' + newimg[i] + ' class = "img_height " /></div>'
								$(".swiper-wrapper").append(img);
							}
							//  图片轮播js
							var swiper = new Swiper('.swiper-container', {
								pagination: '.swiper-pagination',
								nextButton: '.swiper-button-next',
								prevButton: '.swiper-button-prev',
								paginationClickable: true,
								spaceBetween: 0,
								centeredSlides: true,
								autoplay: 2000, //动画播放时间间隔在此设置
								autoplayDisableOnInteraction: false,
								//noSwiping:true,
							});
						}
					}
				},
				error: function(e) {
					appcan.window.openToast('服务器出错1!', '500');
				}
			});
		}
	</script>

</html>